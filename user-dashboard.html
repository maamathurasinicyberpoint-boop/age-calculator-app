<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>User Dashboard - Manoj Babu CSC</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: system-ui, Arial, sans-serif; background: #f9fafb; color: #111; }
    header { background: #111827; color: #fff; padding: 16px 20px; }
    header h1 { font-size: 1.5rem; margin-bottom: 4px; }
    .muted { color: #d1d5db; }
    main { max-width: 1100px; margin: 20px auto; padding: 20px; }
    .section { background: #fff; padding: 24px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,.08); margin-bottom: 20px; }
    h2 { margin-bottom: 16px; color: #111827; }
    .chip { display: inline-block; background: #eef2ff; color: #3730a3; padding: 6px 10px; border-radius: 999px; font-weight: 600; }
    .nav-links { margin-bottom: 20px; }
    .nav-links a { margin-right: 15px; color: #111827; text-decoration: none; font-weight: 500; }
    .nav-links a:hover { text-decoration: underline; }
    table { width: 100%; border-collapse: collapse; margin-top: 12px; }
    th, td { padding: 10px; text-align: left; border-bottom: 1px solid #e5e7eb; }
    th { background: #f3f4f6; font-weight: 600; }
    input, select, button { padding: 8px 12px; border: 1px solid #d1d5db; border-radius: 6px; }
    button { background: #111827; color: #fff; cursor: pointer; font-weight: 500; border: none; }
    button:hover { background: #1f2937; }
    button.secondary { background: #6b7280; }
    button.secondary:hover { background: #4b5563; }
    .form-group { margin-bottom: 12px; }
    .form-group label { display: block; margin-bottom: 4px; font-weight: 500; }
    .status-pending { color: #d97706; font-weight: 600; }
    .status-processing { color: #2563eb; font-weight: 600; }
    .status-completed { color: #059669; font-weight: 600; }
    .status-cancelled { color: #dc2626; font-weight: 600; }
    .service-card { border: 1px solid #e5e7eb; border-radius: 8px; padding: 16px; margin-bottom: 12px; cursor: pointer; }
    .service-card:hover { background: #f9fafb; }
    .service-card.selected { border-color: #111827; background: #f3f4f6; }
    .service-price { font-weight: 600; color: #111827; }
    .payment-qr { text-align: center; padding: 20px; }
    .qr-code { width: 200px; height: 200px; border: 2px solid #e5e7eb; margin: 0 auto 16px; display: flex; align-items: center; justify-content: center; background: #f9fafb; }
  </style>
</head>
<body>
  <header>
    <h1>User Dashboard</h1>
    <div class="muted">Welcome, <span id="name">Guest</span> <span class="chip">User</span></div>
  </header>
  <main>
    <div class="nav-links">
      <a href="index.html">Home</a>
      <a href="login.html">Login</a>
      <a href="#services">Order Services</a>
      <a href="#my-orders">My Orders</a>
    </div>

    <!-- Order Services -->
    <div class="section" id="services">
      <h2>Available Services</h2>
      <div id="servicesList"></div>
      
      <div id="orderForm" style="display:none;">
        <h3>Order Details</h3>
        <div class="form-group">
          <label>Selected Service:</label>
          <input type="text" id="selectedService" readonly>
        </div>
        <div class="form-group">
          <label>Price:</label>
          <input type="text" id="selectedPrice" readonly>
        </div>
        <div class="form-group">
          <label>Your Phone Number:</label>
          <input type="tel" id="phoneNumber" placeholder="e.g., 9876543210" required>
        </div>
        <div class="form-group">
          <label>Your Address:</label>
          <textarea id="address" rows="3" placeholder="Enter your complete address" required></textarea>
        </div>
        <div class="form-group">
          <label>Upload Document (Aadhaar/Other):</label>
          <input type="file" id="document" accept=".jpg,.jpeg,.png,.pdf">
          <small>Optional: Upload Aadhaar card or other required documents</small>
        </div>
        <button onclick="proceedToPayment()">Proceed to Payment</button>
        <button class="secondary" onclick="cancelOrder()">Cancel</button>
      </div>

      <div id="paymentSection" style="display:none;">
        <h3>Payment</h3>
        <div class="payment-qr">
          <div class="qr-code">
            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='160' height='160'%3E%3Crect width='160' height='160' fill='%23000'/%3E%3Crect x='20' y='20' width='20' height='20' fill='%23fff'/%3E%3Crect x='60' y='20' width='20' height='20' fill='%23fff'/%3E%3Crect x='120' y='20' width='20' height='20' fill='%23fff'/%3E%3Crect x='20' y='60' width='20' height='20' fill='%23fff'/%3E%3Crect x='120' y='60' width='20' height='20' fill='%23fff'/%3E%3Crect x='20' y='120' width='20' height='20' fill='%23fff'/%3E%3Crect x='60' y='120' width='20' height='20' fill='%23fff'/%3E%3Crect x='120' y='120' width='20' height='20' fill='%23fff'/%3E%3C/svg%3E" alt="Payment QR Code">
          </div>
          <p><strong>Scan QR Code to Pay</strong></p>
          <p>Amount: ₹<span id="paymentAmount">0</span></p>
          <p><small>UPI ID: manojbabu@paytm</small></p>
          <button onclick="confirmPayment()">I Have Paid</button>
          <button class="secondary" onclick="cancelPayment()">Cancel</button>
        </div>
      </div>
    </div>

    <!-- My Orders -->
    <div class="section" id="my-orders">
      <h2>My Orders</h2>
      <table>
        <thead>
          <tr>
            <th>Order ID</th>
            <th>Service</th>
            <th>Price</th>
            <th>Status</th>
            <th>Date</th>
          </tr>
        </thead>
        <tbody id="myOrdersList">
        </tbody>
      </table>
    </div>
  </main>

  <script>
    // Get user name from URL
    const params = new URLSearchParams(location.search);
    const userName = params.get('name') || 'Guest';
    document.getElementById('name').textContent = userName;

    let selectedServiceData = null;

    // Load services from localStorage
    function loadServices() {
      const services = JSON.parse(localStorage.getItem('services') || '[]');
      const container = document.getElementById('servicesList');
      
      if (services.length === 0) {
        container.innerHTML = '<p>No services available. Please contact admin.</p>';
        return;
      }
      
      container.innerHTML = '';
      services.forEach(service => {
        const card = document.createElement('div');
        card.className = 'service-card';
        card.innerHTML = `
          <h4>${service.name}</h4>
          <p class="service-price">Price: ₹${service.price}</p>
        `;
        card.onclick = () => selectService(service);
        container.appendChild(card);
      });
    }

    function selectService(service) {
      selectedServiceData = service;
      document.querySelectorAll('.service-card').forEach(card => card.classList.remove('selected'));
      event.target.closest('.service-card').classList.add('selected');
      
      document.getElementById('selectedService').value = service.name;
      document.getElementById('selectedPrice').value = '₹' + service.price;
      document.getElementById('orderForm').style.display = 'block';
      document.getElementById('paymentSection').style.display = 'none';
    }

    function proceedToPayment() {
      const phone = document.getElementById('phoneNumber').value.trim();
      const address = document.getElementById('address').value.trim();
      
      if (!phone || !address) {
        alert('Please fill in all required fields');
        return;
      }
      
      document.getElementById('paymentAmount').textContent = selectedServiceData.price;
      document.getElementById('orderForm').style.display = 'none';
      document.getElementById('paymentSection').style.display = 'block';
    }

    function confirmPayment() {
      if (!selectedServiceData) return;
      
      const orders = JSON.parse(localStorage.getItem('orders') || '[]');
      const newOrderId = orders.length > 0 ? Math.max(...orders.map(o => o.id)) + 1 : 1001;
      
      const newOrder = {
        id: newOrderId,
        customerName: userName,
        phone: document.getElementById('phoneNumber').value,
        address: document.getElementById('address').value,
        service: selectedServiceData.name,
        price: selectedServiceData.price,
        status: 'Pending',
        date: new Date().toLocaleDateString('en-IN'),
        document: document.getElementById('document').files[0]?.name || 'None'
      };
      
      orders.push(newOrder);
      localStorage.setItem('orders', JSON.stringify(orders));
      
      alert('Order placed successfully! Order ID: ' + newOrderId);
      
      // Reset form
      cancelOrder();
      loadMyOrders();
    }

    function cancelOrder() {
      document.getElementById('orderForm').style.display = 'none';
      document.getElementById('paymentSection').style.display = 'none';
      document.querySelectorAll('.service-card').forEach(card => card.classList.remove('selected'));
      document.getElementById('phoneNumber').value = '';
      document.getElementById('address').value = '';
      document.getElementById('document').value = '';
      selectedServiceData = null;
    }

    function cancelPayment() {
      document.getElementById('paymentSection').style.display = 'none';
      document.getElementById('orderForm').style.display = 'block';
    }

    function loadMyOrders() {
      const orders = JSON.parse(localStorage.getItem('orders') || '[]');
      const myOrders = orders.filter(order => order.customerName === userName);
      const tbody = document.getElementById('myOrdersList');
      
      if (myOrders.length === 0) {
        tbody.innerHTML = '<tr><td colspan="5" style="text-align:center;">No orders yet</td></tr>';
        return;
      }
      
      tbody.innerHTML = '';
      myOrders.forEach(order => {
        const row = tbody.insertRow();
        const statusClass = 'status-' + order.status.toLowerCase();
        row.innerHTML = `
          <td>${order.id}</td>
          <td>${order.service}</td>
          <td>₹${order.price}</td>
          <td class="${statusClass}">${order.status}</td>
          <td>${order.date}</td>
        `;
      });
    }

    // Initialize
    loadServices();
    loadMyOrders();
  </script>
</body>
</html>
